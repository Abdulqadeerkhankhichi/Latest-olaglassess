
@{
    ViewBag.Title = "MovetoOrdercart";
    int couponid = 0;
    string CouponCode = "";
    double Discount = 0;
    double Discountamount = 0;
    int cartproductscount = 0;
}
<head>
    <style>
        input::-webkit-outer-spin-button,
        input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
    </style>
</head>
<!-- ::::products-hero-aria  start:::::: -->
<section class="products-wishlist-hero-aria">


    <div class="container-fluid custum-pd ">
        <div class="products-wishlist-banner">
            <h2>View Cart</h2>

        </div>
    </div>

</section>
<!-- ::::products-hero-aria  end:::::: -->
<!-- ::::my-cart-area  start:::::: -->
<section class="my-cart-area">
    <!--  -->
    <div class="has-bg">
        <div class="has-bg-3">
            <img src="~/assets/img/Bg-left-2.png" alt="img">
        </div>
        <div class="has-bg-4">
            <img src="~/assets/img/Bg-right-2.png" alt="img">
        </div>
    </div>
    <!--  -->
    <div class="container custum-pd2">
        <!-- <div class="my-cart-section"> -->
        <h3>my cart</h3>
        @{int Subtotatal = 0;}
        @{int UVProtectionvalue = 0;}
        @foreach (var item in ViewBag.Usercartdetails)
        {
            cartproductscount++;
            if (@item.CouponID != null)
            {
                couponid = @item.CouponID;
            }
            if (@item.CouponCode != null)
            {
                CouponCode = @item.CouponCode;
            }
            if (@item.Discount != null)
            {
                Discount = @item.Discount;
            }
            if (@item.Discountamount != null)
            {
                Discountamount = @item.Discountamount;
            }
            //couponid = @item.CouponID;
            //CouponCode = @item.CouponCode;
            //Discount = @item.Discount;
            //Discountamount = @item.Discountamount;
            <div class="my-cart-bg">
                <!-- <div class="my-cart-item">
                </div> -->
                <div class="my-cart-item">

                    <div class="my-cart-bg-product d-flex flex-wrap align-items-center">
                        <div class="product-img ">
                            <img src="@item.ProductImagePath" alt="img">

                        </div>

                        @if (item.Productcategory != "Accessory")
                        {
                            <div class="product-details">
                                <h4>@item.Title</h4>
                                <div class="siz-flex" style="padding-bottom:0px !important">
                                    <ul>
                                        <li><strong> Size</strong></li>
                                        <li> : </li>
                                        <li> @item.Size </li>
                                    </ul>

                                    <ul>
                                        <li><strong>Vision</strong></li>
                                        <li> : </li>
                                        <li>
                                            @item.VisionType


                                            @*<div class="dropdown ">

                    @if (item.VisionType == "Reading")
                    {
                        <input name="@item.Cartid-vision" class='@item.Cartid-vision' type="radio" onclick="updatevalue('RE',@item.Cartid,'@item.Cartid-UVProtection','@item.Cartid-IndividualTotalAmount',39,'@item.Cartid-txtlensamount','@item.Cartid-unitprice','@item.Cartid-totalprice','@item.Cartid-txtquantity')" checked><label>Reading</label>
                    }
                    else
                    {
                        <input name="@item.Cartid-vision" class='@item.Cartid-vision' type="radio" onclick="updatevalue('DI',@item.Cartid,'@item.Cartid-UVProtection','@item.Cartid-IndividualTotalAmount',39,'@item.Cartid-txtlensamount','@item.Cartid-unitprice','@item.Cartid-totalprice','@item.Cartid-txtquantity')"><label>Reading</label>
                    }



                    @if (item.VisionType == "Distance")
                    {
                        <input name="@item.Cartid-vision" class='@item.Cartid-vision' type="radio" onclick="updatevalue('RE',@item.Cartid,'@item.Cartid-UVProtection','@item.Cartid-IndividualTotalAmount',39,'@item.Cartid-txtlensamount','@item.Cartid-unitprice','@item.Cartid-totalprice','@item.Cartid-txtquantity')" checked><label>Distance</label>
                    }
                    else
                    {
                        <input name="@item.Cartid-vision" class='@item.Cartid-vision' type="radio" onclick="updatevalue('DI',@item.Cartid,'@item.Cartid-UVProtection','@item.Cartid-IndividualTotalAmount',39,'@item.Cartid-txtlensamount','@item.Cartid-unitprice','@item.Cartid-totalprice','@item.Cartid-txtquantity')"><label>Distance</label>
                    }


                </div>*@
                                        </li>
                                    </ul>

                                    <ul>

                                        <li><strong>Lens</strong></li>
                                        <li> : </li>
                                        <li>


                                            <div class="dropdown ">
                                                @if (item.UVProtection == "on")
                                                {
                                                    UVProtectionvalue = 20  * @Convert.ToInt32(item.Quantity);
                                                }
                                                else
                                                {
                                                    UVProtectionvalue = 0;
                                                }
                                                @if (item.LensType == "Standard")
                                                {
                                                    Subtotatal += (Convert.ToInt32(39) * @Convert.ToInt32(item.Quantity)) + (Convert.ToInt32(item.Price) * @Convert.ToInt32(item.Quantity)) + Convert.ToInt32(UVProtectionvalue);
                                                    <input id='@item.Cartid-txtlensamount' value="39" hidden />
                                                    @*<input onclick="updatevalue('SL',@item.Cartid,'@item.Cartid-UVProtection','@item.Cartid-IndividualTotalAmount',39,'@item.Cartid-txtlensamount','@item.Cartid-unitprice','@item.Cartid-totalprice','@item.Cartid-txtquantity')" name="@item.Cartid-lens" class='@item.Cartid-lens' type="radio" checked><label>Standard Lens ($39)</label>
                        <input onclick="updatevalue('EL',@item.Cartid,'@item.Cartid-UVProtection','@item.Cartid-IndividualTotalAmount',49,'@item.Cartid-txtlensamount','@item.Cartid-unitprice','@item.Cartid-totalprice','@item.Cartid-txtquantity')" name="@item.Cartid-lens" class='@item.Cartid-lens' type="radio"> <label>Enhanced Lens ($49)</label>*@
                                                    <p id='@item.Cartid-lbllenstype'> Standard Lens($39)</p>
                                                    <input id='@item.Cartid-txtlenstype' value="Standard Lens($39)" hidden />
                                                }
                                                else if (item.LensType == "Enhanced")
                                                {
                                                    Subtotatal += (Convert.ToInt32(49) * @Convert.ToInt32(item.Quantity)) + (Convert.ToInt32(item.Price) * @Convert.ToInt32(item.Quantity)) + Convert.ToInt32(UVProtectionvalue);
                                                    <input id='@item.Cartid-txtlensamount' value="49" hidden />
                                                    @*<input onclick="updatevalue('SL',@item.Cartid,'@item.Cartid-UVProtection','@item.Cartid-IndividualTotalAmount',39,'@item.Cartid-txtlensamount','@item.Cartid-unitprice','@item.Cartid-totalprice','@item.Cartid-txtquantity')" name="@item.Cartid-lens" class='@item.Cartid-lens' type="radio"><label>Standard Lens ($39)</label>
                        <input onclick="updatevalue('EL',@item.Cartid,'@item.Cartid-UVProtection','@item.Cartid-IndividualTotalAmount',49,'@item.Cartid-txtlensamount','@item.Cartid-unitprice','@item.Cartid-totalprice','@item.Cartid-txtquantity')" name="@item.Cartid-lens" class='@item.Cartid-lens' type="radio" checked> <label>Enhanced Lens ($49)</label>*@
                                                    <p id='@item.Cartid-lbllenstype'> Enhanced Lens($49)</p>
                                                    <input id='@item.Cartid-txtlenstype' value="Enhanced Lens($49)" hidden />
                                                }
                                                else if (item.LensType == "Premium Coatings")
                                                {
                                                    Subtotatal += (Convert.ToInt32(49) * @Convert.ToInt32(item.Quantity)) + (Convert.ToInt32(item.Price) * @Convert.ToInt32(item.Quantity)) + Convert.ToInt32(UVProtectionvalue);
                                                    <input id='@item.Cartid-txtlensamount' value="49" hidden />
                                                    @*<input onclick="updatevalue('SL',@item.Cartid,'@item.Cartid-UVProtection','@item.Cartid-IndividualTotalAmount',39,'@item.Cartid-txtlensamount','@item.Cartid-unitprice','@item.Cartid-totalprice','@item.Cartid-txtquantity')" name="@item.Cartid-lens" class='@item.Cartid-lens' type="radio"><label>Standard Lens ($39)</label>
                        <input onclick="updatevalue('EL',@item.Cartid,'@item.Cartid-UVProtection','@item.Cartid-IndividualTotalAmount',49,'@item.Cartid-txtlensamount','@item.Cartid-unitprice','@item.Cartid-totalprice','@item.Cartid-txtquantity')" name="@item.Cartid-lens" class='@item.Cartid-lens' type="radio" checked> <label>Enhanced Lens ($49)</label>*@
                                                    <p id='@item.Cartid-lbllenstype'> Premium Coatings($49)</p>
                                                    <input id='@item.Cartid-txtlenstype' value="Premium Coatings($49)" hidden />
                                                }



                                            </div>
                                        </li>
                                    </ul>
                                    @if (Convert.ToInt32(item.Extracharges) > 0)
                                    {
                                        <ul>

                                            <li><strong>Extra Charges</strong></li>
                                            <li> : </li>
                                            <li>


                                                <div class="dropdown ">

                                                    @{
                                                        Subtotatal += Convert.ToInt32(15) *  @Convert.ToInt32(item.Quantity);
                                                    }
                                                    <p> $15</p>
                                                    <input id='@item.Cartid-lblextracharges' value="15" hidden />




                                                </div>
                                            </li>
                                        </ul>
                                    }
                                    else
                                    {
                                        <p style="display:none" > 0</p>
                                        <input id='@item.Cartid-lblextracharges' value="" hidden />
                                    }
                                </div>
                                <div class="lien">

                                    @if (item.LensType == "Standard")
                                    {
                                        <label class="lien-chackbox">
                                            @*UV Protection ($20)*@
                                            Add Premium Coatings (Only+$10)

                                            <input id="@item.Cartid-premium" onclick="updatevalue('PC',@item.Cartid,'@item.Cartid-UVProtection','@item.Cartid-IndividualTotalAmount',0,'@item.Cartid-txtlensamount','@item.Cartid-unitprice','@item.Cartid-totalprice','@item.Cartid-txtquantity','@item.Cartid-premium','@item.Cartid-lbllenstype','@item.Cartid-txtlenstype','@item.Cartid-lblextracharges')" type="checkbox">
                                            <span class="checkmark"></span>


                                        </label>
                                    }
                                    else if (item.LensType == "Premium Coatings")
                                    {
                                        <label class="lien-chackbox">
                                            @*UV Protection ($20)*@
                                            Add Premium Coatings (Only+$10)

                                            <input checked="checked" id="@item.Cartid-premium" onclick="updatevalue('PC',@item.Cartid,'@item.Cartid-UVProtection','@item.Cartid-IndividualTotalAmount',0,'@item.Cartid-txtlensamount','@item.Cartid-unitprice','@item.Cartid-totalprice','@item.Cartid-txtquantity','@item.Cartid-premium','@item.Cartid-lbllenstype','@item.Cartid-txtlenstype','@item.Cartid-lblextracharges')" type="checkbox">
                                            <span class="checkmark"></span>


                                        </label>
                                    }
                                    <label class="lien-chackbox">
                                        @*UV Protection ($20)*@
                                        Add Photochromic Coating (Only+$20) <br />
                                        for UV Protection
                                        @if (item.UVProtection == "on")
                                        {
                                            <input id="@item.Cartid-UVProtection" onclick="updatevalue('UV',@item.Cartid,'@item.Cartid-UVProtection','@item.Cartid-IndividualTotalAmount',0,'@item.Cartid-txtlensamount','@item.Cartid-unitprice','@item.Cartid-totalprice','@item.Cartid-txtquantity','@item.Cartid-premium','@item.Cartid-lbllenstype','@item.Cartid-txtlenstype','@item.Cartid-lblextracharges')" type="checkbox" checked="checked">
                                            <span class="checkmark"></span>
                                        }
                                        else
                                        {
                                            <input id="@item.Cartid-UVProtection" onclick="updatevalue('UV',@item.Cartid,'@item.Cartid-UVProtection','@item.Cartid-IndividualTotalAmount',0,'@item.Cartid-txtlensamount','@item.Cartid-unitprice','@item.Cartid-totalprice','@item.Cartid-txtquantity','@item.Cartid-premium','@item.Cartid-lbllenstype','@item.Cartid-txtlenstype','@item.Cartid-lblextracharges')" type="checkbox">
                                            <span class="checkmark"></span>
                                        }

                                    </label>

                                </div>
                            </div>
                        }
                        else
                        {
                            <div class="product-details">
                                <h4>@item.Title</h4>
                                <input id="@item.Cartid-UVProtection" hidden />
                                <input id='@item.Cartid-txtlensamount' value="0" hidden />
                                @{Subtotatal += @Convert.ToInt32(@item.Price) * @Convert.ToInt32(item.Quantity);}
                                <div class="siz-flex">
                                    <ul>
                                        <li><strong> Size</strong></li>
                                        <li> : </li>
                                        <li> @item.Size </li>
                                    </ul>
                                </div>
                            </div>
                        }

                    </div>



                </div>
                <div class="my-cart-item ">
                    <div class="number-p">
                        <button class="min minus"
                                onclick="this.parentNode.querySelector('input[type=number]').stepDown(),updatevalue('QL',@item.Cartid,'@item.Cartid-UVProtection','@item.Cartid-IndividualTotalAmount',0,'@item.Cartid-txtlensamount','@item.Cartid-unitprice','@item.Cartid-totalprice','@item.Cartid-txtquantity','@item.Cartid-premium','@item.Cartid-lbllenstype','@item.Cartid-txtlenstype','@item.Cartid-lblextracharges')">
                            -
                        </button>
                        <input id="@item.Cartid-txtquantity" class="quantity number" min="1" name="quantity" value="@item.Quantity" type="number">
                        <button onclick="this.parentNode.querySelector('input[type=number]').stepUp() ,updatevalue('QL',@item.Cartid,'@item.Cartid-UVProtection','@item.Cartid-IndividualTotalAmount',0,'@item.Cartid-txtlensamount','@item.Cartid-unitprice','@item.Cartid-totalprice','@item.Cartid-txtquantity','@item.Cartid-premium','@item.Cartid-lbllenstype','@item.Cartid-txtlenstype','@item.Cartid-lblextracharges')"
                                class="plus max">
                            +
                        </button>
                    </div>

                </div>
                <div class="my-cart-item ">
                    <div class="unit">
                        <span>
                            unit price
                        </span>
                        <h5>
                            <input hidden id='@item.Cartid-unitprice' value="@item.Price" />
                            $@item.Price
                        </h5>
                    </div>

                </div>
                <div class="my-cart-item ">
                    <div class="unit">
                        <span>
                            Totalt price
                        </span>
                        @{int Totalprice = 0;}
                        @{int UVProtection = 0;}
                        @{int Extracharges = 0;}



                        @if (@item.UVProtection == "on")
                        {
                            UVProtection = 20  * @Convert.ToInt32(item.Quantity);
                        }
                        else
                        {
                            UVProtection = 0;
                        }
                        @if (Convert.ToInt32(@item.Extracharges) > 0)
                        {
                            Extracharges =  15 * @Convert.ToInt32(item.Quantity);
                        }

                        @if (item.Productcategory != "Accessory")
                        {
                            if (item.LensType == "Standard")
                            {
                                Totalprice = (@Convert.ToInt32(item.Price) * @Convert.ToInt32(item.Quantity)) + (@Convert.ToInt32(39) * @Convert.ToInt32(item.Quantity)) + @Convert.ToInt32(UVProtection) + @Convert.ToInt32(Extracharges) ;



                            }
                            else if (item.LensType == "Premium Coatings")
                            {
                                Totalprice = (@Convert.ToInt32(item.Price) * @Convert.ToInt32(item.Quantity)) + (@Convert.ToInt32(39) * @Convert.ToInt32(item.Quantity)) + @Convert.ToInt32(UVProtection) + 10 + @Convert.ToInt32(Extracharges);


                            }
                            else
                            {
                                Totalprice = (@Convert.ToInt32(item.Price) * @Convert.ToInt32(item.Quantity)) + (@Convert.ToInt32(49) * @Convert.ToInt32(item.Quantity))  + @Convert.ToInt32(UVProtection) + @Convert.ToInt32(Extracharges);


                            }
                        }
                        else
                        {
                            Totalprice = @Convert.ToInt32(item.Price) * @Convert.ToInt32(item.Quantity);
                        }

                        <input class="classtotalprice" id='@item.Cartid-IndividualTotalAmount' value="@Totalprice" hidden />
                        <h5 id='@item.Cartid-totalprice'>
                            $@Totalprice

                        </h5>

                    </div>
                </div>

                <div class="my-cart-item ">
                    <a href="@Url.Action("Deletecart","Products",new {Cartid=@item.Cartid })">
                        <img class="close-icon img-fluid" src="~/assets/img/vew-chart-clos.png" alt="img">
                    </a>
                </div>
            </div>
        }





        @if (cartproductscount == 0)
        {
            <div class="coupon" style="display:none">
                <form>
                    @if (CouponCode != null && CouponCode.Trim() != "")
                    {
                        <input disabled value="@CouponCode.Trim()" id="txtcouponcode" type="text" placeholder="Enter coupon Code">
                        <button id="btnreversecoupon" onclick="Applycoupon('R')" type="button" style="background-color:#00B0DC !important">Reverse coupon</button>
                        <button style="display:none" id="btnapplycoupon" onclick="Applycoupon('A')" type="button">Apply coupon</button>
                    }
                    else
                    {

                        <input value="" id="txtcouponcode" type="text" placeholder="Enter coupon Code">
                        <button id="btnapplycoupon" onclick="Applycoupon('A')" type="button">Apply coupon</button>
                        <button id="btnreversecoupon" onclick="Applycoupon('R')" type="button" style="background-color:#00B0DC !important;display:none">Reverse coupon</button>
                    }



                    <h4 id="couponerror" style="color:red;display:none">Invalid Coupon</h4>
                </form>

            </div>

        }
        else
        {
            <div class="coupon">
                <form>
                    @if (CouponCode != null && CouponCode.Trim() != "")
                    {
                        <input disabled value="@CouponCode.Trim()" id="txtcouponcode" type="text" placeholder="Enter coupon Code">
                        <button id="btnreversecoupon" onclick="Applycoupon('R')" type="button" style="background-color:#00B0DC !important">Reverse coupon</button>
                        <button style="display:none" id="btnapplycoupon" onclick="Applycoupon('A')" type="button">Apply coupon</button>
                    }
                    else
                    {

                        <input value="" id="txtcouponcode" type="text" placeholder="Enter coupon Code">
                        <button id="btnapplycoupon" onclick="Applycoupon('A')" type="button">Apply coupon</button>
                        <button id="btnreversecoupon" onclick="Applycoupon('R')" type="button" style="background-color:#00B0DC !important;display:none">Reverse coupon</button>
                    }



                    <h4 id="couponerror" style="color:red;display:none">Invalid Coupon</h4>
                </form>

            </div>
        }

        <!-- </div> -->
    </div>
</section>
<!-- ::::my-cart-area end:::::: -->
<!-- ::::  Indepenend start:::::: -->
<section class="indepenend">
    <!--  -->
    <!--  -->
    <div class="has-bg">
        <div class="has-bg-3">
            <img src="~/assets/img/Bg-right-1.png" alt="img">
        </div>
        <div class="has-bg-4">
            <img src="~/assets/img/Bg-left-1.png" alt="img">
        </div>
    </div>
    <!--  -->
    <!--  -->
    <div class="container custum-pd2">
        <h2>Indepenend accsories Selection</h2>
        <div class="indepenend-flex d-flex justify-content-between flex-wrap">
            <div class="product-gallary">
                <div class="indepenend-left"></div>
                <div class="indepenend-left-item">
                    @foreach (var item in ViewBag.ProductList1)
                    {
                        <div class="box">
                            <div class="img">
                                <img class="img-fluid" src="@item.ImagePath" alt="img">
                            </div>
                            <div class="box-details">
                                <h6>@item.Title</h6>
                                <div class="box-cart-area">
                                    <span>$@item.Price</span>
                                    @if (Convert.ToInt32(ViewBag.UserID) != 0)
                                    {
                                        <a class="ccart-button" href="@Url.Action("AddtoCart", "Products", new { ProductID = @item.GlassID, price = @item.Price, Name = @item.Title, Image = @item.ImagePath, color = "zz", size = "No size", type = 0, UserID = @ViewBag.UserID })">Add to cart</a>
                                    }
                                    else
                                    {
                                        <a class="ccart-button" href="#" data-bs-toggle="modal" data-bs-target="#exampleModal" data-toggle="tooltip" title="Login">Add to cart</a>
                                    }
                                </div>

                            </div>
                        </div>
                    }
                </div>
            </div>
            @if (cartproductscount == 0)
            {
                <div class="order-details" style="display:none">
                    <div class="indepenend-right">
                        <h4>Summary</h4>

                        @*<span>Items: </span>*@
                        <div class="subtotal">
                            <p>Subtotal:</p>
                            <span id="spandisplaysubtotal">$@Subtotatal</span>
                        </div>
                        <div class="subtotal">
                            <p>Tax <small>(5%):</small></p>
                            <span id="spandisplaytax">%</span>
                        </div>

                        <div class="subtotal">
                            <p>Shipping Charges:</p>
                            <input id="txtshippingcharges" value="9" hidden />
                            <span id="spandisplayshipping">$9</span>
                        </div>

                        @if (couponid > 0)
                        {
                            <div class="subtotal" id="discountdiv">
                                <i class="fa fa-times"></i>
                                <p>
                                    Disount: <small id="discountpercentage">(@Discount) </small>

                                    <span id="spandisplaydiscountamount">$@Discountamount</span>
                                </p>


                            </div>
                        }
                        else
                        {
                            <div class="subtotal" id="discountdiv" style="display:none">
                                <i class="fa fa-times"></i>
                                <p>
                                    Disount: <small id="discountpercentage"> </small>

                                    @*<span id="spandisplaydiscountamount">%</span>*@
                                </p>


                            </div>
                        }


                        <div class="Ordertotal d-flex justify-content-between align-items-center flex-wrap">

                            <h3>Order total</h3>
                            <h3 id="lblordertotal">$164.98</h3>

                        </div>
                        <p>shipping, tax and shipping protection not included</p>
                        <div class="payments">
                            <img src="~/assets/img/pay-logo.png" alt="img">
                            <p>
                                Pay in 4 interest-free payments
                                of $19.48 .
                            </p>
                        </div>

                       
                            <form action="@Url.Action("Index1","PaymentProcess")" method="post">
                                <input id="txtdiscountamount" value="@Discountamount" name="txtdiscountamount" hidden />
                                <input id="txtdiscountpercentage" value="@Discount" name="txtdiscountpercentage" hidden />
                                <input value="@Subtotatal" id="txtsubtotal" name="txtsubtotal" hidden />
                                <input value="@ViewBag.UserID" id="id" name="id" hidden />
                                <input value="@Subtotatal" id="txtordertotal" name="txtordertotal" hidden />

                                @if (Convert.ToInt32(ViewBag.UserID) != 0)
                                {

                                    <button type="submit" class="proceed-btn d-block" style="width: 100%;">  Proceed to checkout</button>

                                }
                                else
                                {

                                    <a class="proceed-btn d-block" data-bs-toggle="modal" data-bs-target="#exampleModal">Proceed to checkout</a>



                                }
                            </form>
                        @*}
                        else
                        {
                            <form action="@Url.Action("Checkout","PaymentProcess")" method="get">
                                <input id="txtdiscountamount" value="0" name="txtdiscountamount" hidden />
                                <input value="@Subtotatal" id="txtsubtotal" name="txtsubtotal" hidden />
                                <input value="@ViewBag.UserID" id="id" name="id" hidden />
                                <input value="@Subtotatal" id="txtordertotal" name="txtordertotal"  />

                                @if (Convert.ToInt32(ViewBag.UserID) != 0)
                                {

                                    <button type="submit" class="proceed-btn d-block" style="width: 100%;">  Proceed to checkout</button>

                                }
                                else
                                {

                                    <a class="proceed-btn d-block" data-bs-toggle="modal" data-bs-target="#exampleModal">Proceed to checkout</a>



                                }
                            </form>
                        }*@


                        @*<div class="paypal-flex ">
                                <a class="paypal" href="#"><img src="~/assets/img/PayPal2.png" alt="img"></a>

                            </div>*@

                    </div>
                </div>
            }
            else
            {
                <div class="order-details">
                    <div class="indepenend-right">
                        <h4>Summary</h4>

                        @*<span>Items: </span>*@
                        <div class="subtotal">
                            <p>Subtotal:</p>
                            <span id="spandisplaysubtotal">$@Subtotatal</span>
                        </div>
                        <div class="subtotal">
                            <p>Tax <small>(5%):</small></p>
                            <span id="spandisplaytax">%</span>
                        </div>

                        <div class="subtotal">
                            <p>Shipping Charges:</p>
                            <input id="txtshippingcharges" value="9" hidden />
                            <span id="spandisplayshipping">$9</span>
                        </div>

                        @if (couponid > 0)
                        {
                    <div class="subtotal" id="discountdiv">
                       <p   style="width:100%"> <i  onclick="Applycoupon('R')"   style="float:right !important" class="fa fa-times"></i></p>
                        <p style="width:100%">Disount: <small id="discountpercentage">(@Discount%) </small>
                        
                                    <span id="spandisplaydiscountamount" style="float:right">$@Discountamount</span>
                        </p>

                        

                    </div>
                        }
                        else
                        {
                    <div class="subtotal" id="discountdiv" style="display:none">
                        <p style="width:100%"> <i onclick="Applycoupon('R')" style="float:right !important" class="fa fa-times"></i></p>
                        <p style="width:100%">
                            Disount: <small id="discountpercentage"> </small>
                            <span id="spandisplaydiscountamount" style="float:right">%</span>
                        </p>


                    </div>
                        }


                        <div class="Ordertotal d-flex justify-content-between align-items-center flex-wrap">

                            <h3>Order total</h3>
                            <h3 id="lblordertotal">$164.98</h3>

                        </div>
                        <p>shipping, tax and shipping protection not included</p>
                        <div class="payments">
                            <img src="~/assets/img/pay-logo.png" alt="img">
                            <p>
                                Pay in 4 interest-free payments
                                of $19.48 .
                            </p>
                        </div>

                        @*@if (Convert.ToInt32(@ViewBag.previousorders) > 0)
                        {*@
                            <form action="@Url.Action("Index1","PaymentProcess")" method="post">
                                <input id="txtdiscountamount" value="@Discountamount" name="txtdiscountamount" hidden />
                                <input id="txtdiscountpercentage" value="@Discount" name="txtdiscountpercentage" hidden />
                                <input value="@Subtotatal" id="txtsubtotal" name="txtsubtotal" hidden />
                                <input value="@ViewBag.UserID" id="id" name="id" hidden />
                                <input value="@Subtotatal" id="txtordertotal" name="txtordertotal" hidden  />

                                @if (Convert.ToInt32(ViewBag.UserID) != 0)
                                {

                                    <button type="submit" class="proceed-btn d-block" style="width: 100%;">  Proceed to checkout</button>

                                }
                                else
                                {

                                    <a class="proceed-btn d-block" data-bs-toggle="modal" data-bs-target="#exampleModal">Proceed to checkout</a>



                                }
                            </form>
                        @*}
                        else
                        {
                            <form action="@Url.Action("Checkout","PaymentProcess")" method="get">
                                <input id="txtdiscountamount" value="0" name="txtdiscountamount" hidden />
                                <input value="@Subtotatal" id="txtsubtotal" name="txtsubtotal" hidden />
                                <input value="@ViewBag.UserID" id="id" name="id" hidden />
                                <input value="@Subtotatal" id="txtordertotal" name="txtordertotal"  />

                                @if (Convert.ToInt32(ViewBag.UserID) != 0)
                                {

                                    <button type="submit" class="proceed-btn d-block" style="width: 100%;">  Proceed to checkout</button>

                                }
                                else
                                {

                                    <a class="proceed-btn d-block" data-bs-toggle="modal" data-bs-target="#exampleModal">Proceed to checkout</a>



                                }
                            </form>
                        }*@


                        @*<div class="paypal-flex ">
                                <a class="paypal" href="#"><img src="~/assets/img/PayPal2.png" alt="img"></a>

                            </div>*@

                    </div>
                </div>
            }

        </div>

    </div>
</section>
<!-- ::::  Indepenend end:::::: -->
<script src="~/Scripts/jquery-3.4.1.js"></script>
<script>




    function updatevalue(updatetype,cartid,UVProtectionstatus, IndividualTotalAmount, Lensstatusvaue, LensPrice, UnitPrice, TotalPrice, TotalQuantity,IsPremiumcoating,lbllenstype,txtlenstype,lblextracharges) {

        var UVProtection = 0;
        var PremiumCoating = 0;
        var IsUVProtectionstatus = $("#" + UVProtectionstatus).is(':checked');
        var IsPremiumcoatingstatus = $("#" + IsPremiumcoating).is(':checked');


        var Quantity = document.getElementById(TotalQuantity).value;
        var price = document.getElementById(UnitPrice).value;
        var txtLensPrice = document.getElementById(LensPrice).value;
        var extracharges = document.getElementById(lblextracharges).value; 
        var Lens = 0;


        if (parseInt(Lensstatusvaue) > 0) {
            document.getElementById(LensPrice).value = Lensstatusvaue;
            Lens = parseInt(Lensstatusvaue);
        }
        else {

            Lens = txtLensPrice;
        }


        var Result;


        if (IsUVProtectionstatus == true) {
            UVProtection = 20;
        }
        else if (IsUVProtectionstatus == false) {
            UVProtection = 0;

        }


        if (updatetype == "PC") {

            if (IsPremiumcoatingstatus == true) {
                PremiumCoating = 10;
                document.getElementById(lbllenstype).innerHTML = "Premium Coatings($49)";
                Lens = 39;
            }
            else if (IsPremiumcoatingstatus == false) {
                PremiumCoating = 0;
                document.getElementById(lbllenstype).innerHTML = "Standard Lens($39)"
                /*document.getElementById(lbllenstype).innerHTML = $("#" + txtlenstype).val();*/
                Lens = 39;
            }
        }



        result = parseInt(Quantity) * parseInt(price);
       /* alert(result + ", " + parseInt(Lens) + ", " + parseInt(UVProtection) + ", " + parseInt(PremiumCoating));*/

        
        result = result + (parseInt(Lens) * parseInt(Quantity)) + (parseInt(UVProtection) * parseInt(Quantity)) + (parseInt(PremiumCoating) * parseInt(Quantity)) + (parseInt(extracharges) * parseInt(Quantity)) ;



        if (!isNaN(result)) {
            document.getElementById(TotalPrice).innerHTML = "$" + result;
        }


        document.getElementById(IndividualTotalAmount).value = result;

        //Get sum of all individual product/rows from user add to cart (price * quantity + lens value (39 or 49))
        var sum = 0;
        $(".classtotalprice").each(function () {
            if (!isNaN(this.value) && this.value.length != 0) {
                sum += parseFloat(this.value);
            }
        });

        document.getElementById("spandisplaysubtotal").innerHTML = "$" + sum;
        $("#txtsubtotal").val(sum);


        Calculateamounts();

        var Subtotalvalue = $("#txtsubtotal").val();
        var Tax = 0;
        Tax = parseFloat((parseInt(Subtotalvalue) / 100) * 5);
        var discount = $("#txtdiscountamount").val();
        var ordertotal = $("#txtordertotal").val();
        $.ajax({

                url: '@Url.Action("Updatecart", "Products")',
                type: "POST",
                dataType: 'JSON',
             data: {
                 updatetype: updatetype, cartid: cartid, quantity: Quantity, subtotal: result, Shippingamount: $("#txtshippingcharges").val(), TaxAmount: Tax
                 , Discount: discount, ordertotal: ordertotal
             },
                success: function (result) {


                }
            });


    }


    $(document).ready(function () {
        Calculateamounts();
        Applycoupon('R')
    });

    function Calculateamounts() {
        /*Get sub total amount*/
        var Subtotalvalue = $("#txtsubtotal").val();

    /*Calculate Tax*/
        var Tax = 0;
        Tax = parseFloat((parseInt(Subtotalvalue) / 100) * 5);
        document.getElementById("spandisplaytax").innerHTML = "$" + Tax.toFixed(2);

        /*Get Shipping charges*/
        var Shippingcharges = $("#txtshippingcharges").val();

        var GrandTotal = 0;

        GrandTotal = parseFloat(Subtotalvalue) + parseFloat(Tax) + parseFloat(Shippingcharges);


        document.getElementById("lblordertotal").innerHTML ="$"+GrandTotal;

        $("#txtordertotal").val(GrandTotal);
    }

    function Applycoupon(Type)
    {
        var Userid = $("#id").val();

        var Discountamount = 0;
        var Grandtotal = $("#txtordertotal").val();
        var couponcode = $("#txtcouponcode").val();

        /*Get sub total amount*/
        var Subtotalvalue = $("#txtsubtotal").val();

        /*Calculate Tax*/
        var Tax = 0;
        Tax = parseFloat((parseInt(Subtotalvalue) / 100) * 5);
        document.getElementById("spandisplaytax").innerHTML = "$" + Tax.toFixed(2);

        /*Get Shipping charges*/
        var Shippingcharges = $("#txtshippingcharges").val();


        if (Type == 'A') {

            $.ajax({

                url: '@Url.Action("Applycoupon", "Products")',
                type: "POST",
                dataType: 'JSON',
                data: { Couponcode: couponcode, Userid: Userid, applytype:"A", Subtotalvalue: Subtotalvalue},
                success: function (result) {
                    if (result.amount != "-1") {
                        $("#discountdiv").fadeIn();
                        document.getElementById('txtcouponcode').disabled = true;
                        if (result.type == "1") {
                            Discountamount = parseFloat(Subtotalvalue) / 100 * parseFloat(result.amount);
                            document.getElementById("discountpercentage").innerHTML = '(' + result.amount + '%)';
                        }
                        else {
                            Discountamount = parseFloat(result.amount);
                            //document.getElementById("discountpercentage").innerHTML = '(' + result.amount + ')';
                        }


                        $("#txtdiscountpercentage").val(result);
                        $("#txtdiscountamount").val(Discountamount.toFixed(1));
                        document.getElementById("spandisplaydiscountamount").innerHTML = "$"+parseFloat(Discountamount).toFixed(1);
                        Grandtotal = parseFloat(Subtotalvalue) - parseFloat(Discountamount);
                       /* $("#txtordertotal").val(Grandtotal);*/
                       // document.getElementById("lblordertotal").innerHTML = "$" + Grandtotal.toFixed(1);
                        $("#couponerror").fadeOut();


                        $("#btnapplycoupon").fadeOut();
                        $("#btnreversecoupon").fadeIn();


                        Grandtotal = parseFloat(Grandtotal) + parseFloat(Tax) + parseFloat(Shippingcharges);

                        $("#txtordertotal").val(Grandtotal);
                        //$("#txtdiscountamount").val(0);
                        //$("#txtcouponcode").val("");
                        document.getElementById("lblordertotal").innerHTML = "$" + Grandtotal.toFixed(1);

                    }
                    else {

                        $("#couponerror").fadeIn();
                        $("#couponerror").fadeOut(8000);
                    }

                }
            });


        }
        else {
            $("#discountdiv").fadeOut();

            $("#btnreversecoupon").fadeOut();
            $("#btnapplycoupon").fadeIn();

            document.getElementById('txtcouponcode').disabled = false;

            $.ajax({

                url: '@Url.Action("Applycoupon", "Products")',
                type: "POST",
                dataType: 'JSON',
                data: { Couponcode: couponcode, Userid: Userid, applytype: "R", Subtotalvalue: Subtotalvalue },
                success: function (result)
                {
                }
            });


            Grandtotal = parseFloat(Grandtotal) + parseFloat($("#txtdiscountamount").val());

            /*Calculate Tax*/
            var Tax = 0;
            Tax = parseFloat((parseInt(Subtotalvalue) / 100) * 5);
            document.getElementById("spandisplaytax").innerHTML = "$" + Tax.toFixed(2);

            /*Get Shipping charges*/
            var Shippingcharges = $("#txtshippingcharges").val();



            GrandTotal = Grandtotal + parseFloat(Tax) + parseFloat(Shippingcharges);
            $("#txtordertotal").val(Grandtotal.toFixed(1));
            $("#txtdiscountamount").val(0);
            $("#txtdiscountpercentage").val(0);
            $("#txtcouponcode").val("");
            document.getElementById("lblordertotal").innerHTML = "$" + Grandtotal.toFixed(1);

        }

    }
</script>